
@using Inventario.ConexionDB.Consultas
@using Inventario.Implement
@using Microsoft.AspNetCore.Http

@inject IHttpContextAccessor HttpContextAccessor
@model MInvListado
@{
    var httpContext = HttpContextAccessor.HttpContext;
    string sucursalNombre = httpContext?.Session?.GetString("SucursalNombre");
    string sucursalAbrev = httpContext?.Session?.GetString("SucursalAbrev");
    string sucursalID = httpContext?.Session?.GetString("SucursalID");



    int contador = 1;

	MComputadora b = new MComputadora();
    var c = new ImEmpleado();
    b.Empleados = c.getEmpleados();
    
}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Inventario de Activos de TI</title>
    <!-- Carga de Bootstrap CSS (v5.3) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <!-- Carga de Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />




    <style>
        body {
            background-color: #f0f2f5; /* Fondo más suave */
        }

        #main-layout {
            display: flex;
            min-height: 100vh;
        }
        /* Sidebar Styling */
        #sidebar {
            width: 250px;
            background-color: #343a40; /* Color oscuro para el menú */
            color: #ffffff;
            padding: 15px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        /* Estilo para habilitar el scroll vertical en el listado de activos */
        .table-scroll-vertical {
            /* Define la altura máxima que ocupará la tabla antes de hacer scroll.
               Ajusta este valor según el diseño de tu página (ej. 400px, 50vh, etc.). */
            max-height: 400px;
            /* Habilita el scroll vertical cuando el contenido supera max-height */
            overflow-y: auto;
            /* Nota: 'table-responsive' ya maneja el overflow-x (horizontal) */
        }

        .sidebar-menu .nav-link {
            color: #ced4da;
            padding: 10px 15px;
            margin-bottom: 5px;
            border-radius: 5px;
            transition: background-color 0.2s, color 0.2s;
        }

            .sidebar-menu .nav-link:hover {
                background-color: #495057;
                color: #ffffff;
            }

            .sidebar-menu .nav-link.active {
                background-color: #007bff; /* Color primario de Bootstrap */
                color: #ffffff;
                font-weight: bold;
            }
        /* Content Styling */
        #main-content {
            flex-grow: 1;
            padding: 30px;
            overflow-x: auto; /* Para tablas grandes */
        }

        .asset-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            padding: 20px;
            margin-bottom: 20px;
        }

        .data-table th, .data-table td {
            font-size: 0.85rem;
            vertical-align: middle;
        }




        /*//////////////////////////Modal de prueba//////////////////////////////////*/

        /* CSS personalizado para mover el botón de cierre (X) a la izquierda */
        #modalUsuario .modal-header {
            display: flex;
            flex-direction: row-reverse; /* Invierte el orden de los elementos */
            justify-content: space-between; /* Distribuye el espacio entre el botón y el título */
        }

            #modalUsuario .modal-header .btn-close {
                order: -1; /* Forzamos al botón de cierre a ser el primer elemento (extremo izquierdo) */
                margin-right: auto; /* Empuja el botón lejos del título */
                margin-left: 0;
            }

            #modalUsuario .modal-header .modal-title {
                margin-right: 0;
                margin-left: auto; /* Mueve el título a la derecha */
            }

            /*/////////////////////Modal Funcional(Bueno)///////////////////////////////////*/
        .modal-fondo {
            display: none; /* Oculto inicialmente */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5); /* Fondo semitransparente */
            justify-content: center;
            align-items: center;
        }

        /* 2. La caja blanca del modal */
        /* .modal-caja {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        } */

        /* Clase para mostrar el modal (usada por JS) */
        .mostrar {
            display: flex;
        }

        .modal-caja {
            /* Propiedades de estilo que ya tengas (ancho, color de fondo, etc.) */
            width: 80%;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            /* 🛑 PROPIEDADES CLAVE PARA EL SCROLL 🛑 */
            /* Define la altura máxima. Usa 'vh' (viewport height) para que se adapte al tamaño de la pantalla. */
            /* Ejemplo: 80vh significa que no excederá el 80% de la altura de la ventana del navegador. */
            max-height: 80vh;
            /* Muestra la barra de desplazamiento vertical solo cuando el contenido exceda max-height. */
            overflow-y: auto;
            /* Opcional: Para evitar que aparezca una barra de desplazamiento horizontal no deseada */
            overflow-x: hidden;
            
        }
        /*////////////////////////////////////////////////////////*/
    </style>
</head>
<body>

    <div id="main-layout">
        <!-- 1. BARRA DE NAVEGACIÓN LATERAL (SIDEBAR) -->
        <nav id="sidebar">
            <h4 class="text-white mb-4 border-bottom pb-2">@sucursalNombre</h4>

            <ul class="nav flex-column sidebar-menu">
                <li class="nav-item">
                    <a class="nav-link active" href="#" data-view="Todo">
                        <i class="fas fa-list-alt me-2"></i> Inventario General
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Empleado">
                        <i class="fas fa-user-tag me-2"></i> Asignación (Empleados)
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="alerts">
                        <i class="fas fa-bell me-2"></i> Alertas y Mantenimiento
                    </a>
                </li>

                <h6 class="text-secondary mt-4 mb-2 ps-3 text-uppercase">Categorías</h6>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Computadora">
                        <i class="fas fa-desktop me-2"></i> Computadoras / Laptops
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Monitor">
                        <i class="fas fa-tv me-2"></i> Monitores
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Impresora">
                        <i class="fas fa-print me-2"></i> Impresoras
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Celular">
                        <i class="fas fa-mobile-alt me-2"></i> Móviles
                    </a>

                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Tablet">
                        <i class="fas fa-tablet-alt me-2"></i> Tablets
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Scanner">
                        <i class="fas fa-print me-2"></i> Escanner
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="Telefono">
                        <i class="fas fa-phone me-2"></i> Teléfono Fijo
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#" data-view="UPS">
                        <i class="fas fa-battery-full me-2"></i> Reguladores
                    </a>
                </li>
            </ul>
        </nav>

        <!-- 2. CONTENIDO PRINCIPAL (DASHBOARD) -->
        <main id="main-content">
            <h2 class="mb-4 text-dark">Inventario General de Activos</h2>

            <!-- Indicadores Clave (KPIs) -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="p-3 bg-white border rounded shadow-sm text-center">
                        <h5 class="text-primary">Total Activos</h5>
                        <p class="fs-3 fw-bold" id="kpi-total">154</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="p-3 bg-white border rounded shadow-sm text-center">
                        <h5 class="text-success">Asignados</h5>
                        <p class="fs-3 fw-bold" id="kpi-assigned">120</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="p-3 bg-white border rounded shadow-sm text-center">
                        <h5 class="text-warning">Sin Asignar</h5>
                        <p class="fs-3 fw-bold" id="kpi-unassigned">34</p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="p-3 bg-white border rounded shadow-sm text-center">
                        <h5 class="text-danger">Próx. Mantenimiento</h5>
                        <p class="fs-3 fw-bold" id="kpi-maintenance">12</p>
                    </div>
                </div>
            </div>

            <!-- Panel de Búsqueda y Acciones -->
            <div class="asset-card d-flex justify-content-between align-items-center">
                <div  style="max-width: 400px;display:flex;">
                    @* <input type="text" class="form-control" placeholder="Buscar por Serial, Modelo o Empleado..." id="ItemSearch"> *@
                    <input type="text" id="txtBuscar" class="form-control" placeholder="Buscar por inventario, serie, modelo o nombre...">
                    <button class="btn btn-primary ms-0" type="button" onclick="buscarItem()"><i class="fas fa-search"></i></button>
                </div>

                <div>
                    @* <button class="btn btn-outline-secondary me-2" onclick="showFilters()"><i class="fas fa-filter me-1"></i> Filtros Avanzados</button> *@
                    @* <button class="btn btn-success" @* onclick="addNewAsset()" ><i class="fas fa-plus me-1"></i> Nuevo Activo</button> *@
                    
                    <button class="btn btn-success" id="btnAccion" > <i class="fas fa-plus me-1"></i> Nuevo Activo</button>
                    
                    
                    
                </div>
            </div>

            <!-- Tabla de Inventario -->
            <div class="asset-card" id="asset-card">
                <h4 class="mb-3 text-secondary">Listado de Activos <span class="badge bg-info" id="asset-count">@Model.Items.Count</span></h4>
                <div class="table-responsive table-scroll-vertical">
                    <table class="table table-hover data-table align-middle" id="TblItem">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>No. Inventario</th>
                                <th>Serial</th>
                                <th>Modelo</th>
                                <th>Ubicación</th>
                                <th>Estado</th>
                                <th>Asignado a</th>
                                @* <th>Acciones</th> *@
                            </tr>
                        </thead>
                        <tbody id="asset-list">
                            
                            @foreach (var item in Model.Items)
                            {
                                
                               
                                <tr>
                                    <td>@contador</td>
                                    <td>@item.No_Inventario</td>
                                    <td>@item.Serie</td>
                                    <td>@item.Modelo</td>
                                    <td>@item.Area</td>
                                    @if (item.Estado == "A")
                                    {
                                        <td>ACTIVO</td>
                                    }
                                    else
                                    {
                                        <td>INACTIVO</td>
                                    }
                                    <td>@item.Nombre</td>
                                    @* <td>
                                        <a asp-action="Detalle"
                                           asp-controller="Inventario"
                                           asp-route-noInventario="@item.No_Inventario"
                                           class="btn btn-sm btn-outline-info"
                                           title="Ver Detalle">
                                            <i class="fas fa-eye"></i>
                                        </a>

                                        <a asp-action="viewItemEditIt"
                                           asp-controller="Articulo"
                                           asp-route-idItem="@item.No_Inventario"
                                           asp-route-Tipo="@item.Tipo"
                                           class="btn btn-sm btn-outline-warning"
                                           title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                    </td> *@
                                </tr>
								contador++;
                            }
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>















    
    @* ////////////////////////////Diseño de modal Bueno////////////////////////////////// *@
    <div id="miModal" class="modal-fondo ">
        <div class="modal-caja ">
            <div id="contenedorTexto"></div>

            <br>
            
        </div>
    </div>



    @* ////////////////////////////Diseño de modal Empleados////////////////////////////////// *@

    <!-- El Popup -->
     @* <div id="myModal" class="modal"> 
    <div class="modal" id="myModal" tabindex="1000" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Seleccionar Empleado</h2>
            <table id="empleadosTable">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Acción</th>
                </tr>
                <!-- Iterar sobre los empleados del modelo -->
                @foreach (var empleado in b.Empleados)
                {
                    <tr>
                        <td>@empleado.Cod_Emple</td>
                        <td>@empleado.Nombre</td>
                        <td><button class="selectEmpleadoBtn" data-cod-emple="@empleado.Cod_Emple" data-nombre="@empleado.Nombre">Seleccionar</button></td>
                    </tr>
                }
            </table>
        </div>
    </div> *@



    <div class="modal" id="myModal" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="myModalLabel">Seleccionar Empleado</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>

                <div class="modal-body">

                    <table id="empleadosTable" class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Acción</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var empleado in b.Empleados)
                            {
                                <tr>
                                    <td>@empleado.Cod_Emple</td>
                                    <td>@empleado.Nombre</td>
                                    <td>
                                        <button type="button"
                                                class="btn btn-sm btn-primary selectEmpleadoBtn"
                                                data-cod-emple="@empleado.Cod_Emple"
                                                data-nombre="@empleado.Nombre">
                                            Seleccionar
                                        </button>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>

            </div>
        </div>
    </div>

 


    <script>
        // Define esta variable globalmente en tu vista, antes de cargar ViewMenu.js
        const SUCURSAL_ID_ACTUAL = '@sucursalID';
    </script>

    <script src="~/js/ViewMenu.js"></script>
    

</body>
</html>
